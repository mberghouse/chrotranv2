# 1D slab geometry with boundary conditions set to initial
#
# Multiple continuum test
# David Fukuyama
# 04/10/23
#--------------------------------------------------------------------

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE GENERAL
      OPTIONS
        SOLUTE SALT
        MULTIPLE_CONTINUUM
      /
    /
  /
END

SUBSURFACE

#=========================== numerical methods ================================
NUMERICAL_METHODS FLOW

  TIMESTEPPER
    TS_ACCELERATION 5
    PRESSURE_CHANGE_GOVERNOR 1.e5
    TEMPERATURE_CHANGE_GOVERNOR 5.
  /

  NEWTON_SOLVER
    ATOL 1D-8
    RTOL 1D-8
    STOL 1D-30
    DTOL 1D15
    ITOL 1D-8
    MAXIMUM_NUMBER_OF_ITERATIONS 25
    MAXF 100
  /

END

#=========================== regression ===================================
REGRESSION
  CELL_IDS
    5
  /
  CELLS_PER_PROCESS 5
END

#=========================== discretization ===================================
GRID
TYPE STRUCTURED
ORIGIN 0.d0 0.d0 0.d0
NXYZ 1 1 1
BOUNDS
  0.d0 0.d0 0.d0
  1.d0 1.d0 1.d0
/
END

#=========================== solver options ===================================


#=========================== times ============================================
TIME
FINAL_TIME 1.d0 y
INITIAL_TIMESTEP_SIZE 1.d-8 y
MAXIMUM_TIMESTEP_SIZE 0.1d0 y
/

#=========================== output options ===================================
OUTPUT
  TIMES y 0.005 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 0.5 1.d0
  #PERIODIC_OBSERVATION TIMESTEP 1
  #SCREEN PERIODIC 10
  #PRINT_COLUMN_IDS
  #FORMAT TECPLOT POINT
  FORMAT HDF5
/

#=========================== fluid properties =================================
FLUID_PROPERTY
DIFFUSION_COEFFICIENT 1.d-9
/

#=========================== material properties ==============================
MATERIAL_PROPERTY rock1
  ID 1
  POROSITY 1.d-4
  ROCK_DENSITY 2.65E3
  SPECIFIC_HEAT 1E3
  THERMAL_CONDUCTIVITY_DRY 2.51
  THERMAL_CONDUCTIVITY_WET 2.51
  CHARACTERISTIC_CURVES cc1
  PERMEABILITY
    PERM_X 1.d-13
    PERM_Y 1.d-13
    PERM_Z 1.d-13
  /
  SECONDARY_CONTINUUM
    TYPE SLAB 
    LENGTH 1 #half distance between fractures - BC location in the matrix
    NUM_CELLS 5 #in secondary continuum (matrix)
    EPSILON 0.00005 #fracture volume fraction (b/(L+b))
    LIQUID_DIFFUSION_COEFFICIENT 1.6d-10  #effective diffusion coefficient, includes tortuosity
    #TEMPERATURE 50.d0
    POROSITY 0.01 #diffusion coefficient and porosity are multiplied, no tortuosity in eqn
    SALT_MOLE_FRACTION 1.D-6
   /
END

#=========================== saturation functions =============================

CHARACTERISTIC_CURVES cc1
  SATURATION_FUNCTION VAN_GENUCHTEN
    LIQUID_RESIDUAL_SATURATION 0.2d0
    ALPHA 1.d-4
    M 0.5d0
    MAX_CAPILLARY_PRESSURE 1.d6
  /
  PERMEABILITY_FUNCTION MUALEM
    PHASE LIQUID
    LIQUID_RESIDUAL_SATURATION 0.2d0
    M 0.5d0
  /
  PERMEABILITY_FUNCTION MUALEM_VG_GAS
    PHASE GAS
    LIQUID_RESIDUAL_SATURATION 0.2d0
    GAS_RESIDUAL_SATURATION 0.1d0
    M 0.5d0
  /
/

#=========================== regions ==========================================

REGION all
COORDINATES
  0.d0 0.d0 0.d0
  1.d0 1.d0 1.d0
/
END

REGION east
  FACE EAST
  COORDINATES
    1.d0 0.d0 0.d0
    1.d0 1.d0 1.d0
  /
END

REGION west
  FACE WEST
  COORDINATES
    0.d0 0.d0 0.d0
    0.d0 1.d0 1.d0
  /
END

REGION obs
COORDINATES
  0.5d0 0.5d0 0.5d0
  0.5d0 0.5d0 0.5d0
/
END

skip
OBSERVATION
  REGION obs
  AT_CELL_CENTER
  SECONDARY_TEMPERATURE
END
noskip


#=========================== flow conditions ==================================
FLOW_CONDITION initial
  TYPE
    LIQUID_PRESSURE DIRICHLET
    MOLE_FRACTION DIRICHLET
    SALT_MOLE_FRACTION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  LIQUID_PRESSURE 1.11325D5
  MOLE_FRACTION 1.D-7
  SALT_MOLE_FRACTION 1.D-2
  TEMPERATURE 25.d0
/


#=========================== condition couplers ===============================
# initial condition
INITIAL_CONDITION
  FLOW_CONDITION initial
  REGION all
END

# BOUNDARY_CONDITION
#   FLOW_CONDITION initial
#   REGION west
# END

# BOUNDARY_CONDITION
#   FLOW_CONDITION initial
#   REGION east
# END


#=========================== stratigraphy couplers ============================
STRATA
  REGION all
  MATERIAL rock1
END



END_SUBSURFACE
